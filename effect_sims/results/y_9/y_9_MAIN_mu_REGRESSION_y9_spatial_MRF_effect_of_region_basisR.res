BayesX.design.matrix <- function(x, ...) {
  w <- getOption("warn")
  options(warn = -1)
  tx <- as.integer(as.character(unlist(x)))
  options("warn" = w)
  x <- if(!any(is.na(tx))) tx else as.integer(x)
  levels <- c(1001, 1054, 1059, 1002, 1051, 1058, 1057, 1004, 1055, 3405, 1061, 1060, 1056, 1062, 1003, 4012, 3462, 3452, 3402, 3455, 3352, 3359, 2000, 1053, 3354, 3403, 3461, 3356, 5154, 3457, 3451, 3357, 3355, 3353, 3360, 3103, 4011, 3458, 3401, 3361, 5313, 5370, 5166, 5116, 5114, 3456, 5170, 5554, 5916, 5112, 5111, 5513, 5512, 5119, 5117, 3460, 3454, 3453, 3404, 3358, 3351, 3201, 3151, 3154, 3101, 3251, 3256, 5354, 5358, 5162, 5316, 5122, 5566, 5515, 5562, 5558, 5911, 5158, 5113, 5913, 3459, 7211, 3253, 3157, 3158, 3102, 5770, 5758, 5711, 3257, 3252, 5366, 5362, 5315, 5314, 5378, 5124, 5120, 5915, 5570, 5978, 5954, 5914, 5754, 7232, 10042, 7235, 10044, 3254, 3153, 3156, 5766, 3255, 7233, 7131, 5382, 5374, 5974, 5962, 5774, 7231, 7135, 10046, 7134, 10043, 10041, 6611, 3155, 3152, 5762, 7138, 7137, 7111, 7132, 5966, 5958, 7141, 7140, 7336, 7133, 10045, 7320, 7317, 7312, 6633, 6636, 6635, 7143, 5970, 6533, 6439, 7339, 7315, 6414, 7335, 7333, 7331, 7340, 7316, 7313, 8336, 8311, 6634, 6632, 6534, 6532, 6531, 6436, 6434, 6411, 6433, 8211, 7332, 7319, 7314, 7311, 7337, 8337, 8316, 8315, 8317, 6631, 6535, 6440, 6413, 6412, 6438, 6432, 8222, 8221, 6431, 8216, 8212, 7338, 7334, 7318, 8231, 9662, 9673, 9463, 8326, 8325, 8237, 8235, 9663, 9672, 6435, 9671, 9661, 6437, 8226, 8215, 8121, 8236, 8115, 9476, 9464, 9678, 9674, 9478, 9473, 9461, 8335, 8327, 8417, 8416, 9675, 9679, 9677, 9676, 8225, 8126, 8125, 8118, 8111, 8116, 9479, 9477, 9475, 9471, 9462, 9563, 9562, 8421, 8435, 8437, 8415, 9575, 9561, 8128, 8127, 8119, 8117, 8425, 9377, 9363, 9572, 9474, 9472, 9361, 9573, 9565, 9564, 9776, 9763, 9775, 9764, 8436, 8426, 9571, 8136, 8135, 9774, 9773, 9374, 9574, 9371, 9577, 9576, 9780, 9778, 9762, 9779, 9772, 9761, 9185, 9161, 9262, 9272, 9376, 9362, 9372, 9276, 9263, 9373, 9176, 9777, 9181, 9771, 9186, 9275, 9271, 9375, 9279, 9278, 9273, 9261, 9190, 9180, 9172, 9188, 9179, 9178, 9174, 9162, 9277, 9274, 9171, 9173, 9177, 9189, 9184, 9183, 9182, 9175, 9187, 9163)
  x <- factor(x, levels = levels)
  X <- diag(length(levels))[x, ]
  attr(X, "type") <- "mrf"
  return(X)
}
